{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nexport let FriendRequestReceivedComponent = class FriendRequestReceivedComponent {\n  constructor(friendsService, router) {\n    this.friendsService = friendsService;\n    this.router = router;\n    this.requests = [];\n    this.filteredRequests = [];\n    this.searchText = '';\n    this.expanded = {};\n    this.mutualFriendsMap = {};\n    this.ObjectKeys = Object.keys;\n  }\n  ngOnInit() {\n    this.loadRequests();\n  }\n  viewProfile(friend) {\n    alert(`Viewing profile of ${friend.username}`);\n    this.router.navigate(['friends/profile', friend.userId]);\n  }\n  loadRequests() {\n    this.friendsService.getFriendRequestsReceived(localStorage.getItem('userId')).subscribe({\n      next: data => {\n        this.requests = data;\n        this.filteredRequests = data;\n        for (let i of this.requests) {\n          this.friendsService.findMutualFriend(localStorage.getItem(\"userId\"), i.sender.userId).subscribe({\n            next: data => {\n              this.mutualFriendsMap[i.sender.userId] = data;\n            },\n            error: err => console.error('Error loading mutual friends', err)\n          });\n        }\n      },\n      error: err => console.error('Error loading received requests', err)\n    });\n  }\n  onSearchChange() {\n    const text = this.searchText.toLowerCase();\n    this.requests = this.filteredRequests.filter(request => request.sender.username.toLowerCase().includes(text));\n  }\n  accept(id) {\n    this.friendsService.acceptFriendRequest(id, localStorage.getItem('userId')).subscribe({\n      next: data => alert(data),\n      error: err => alert(\"Request can't be accepted\")\n    });\n  }\n  reject(id) {\n    this.friendsService.rejectFriendRequest(id, localStorage.getItem('userId')).subscribe({\n      next: data => alert(data),\n      error: err => alert(\"Request can't be rejected\")\n    });\n  }\n  // store loaded lists\n  toggleDropdown(friendId) {\n    this.expanded[friendId] = !this.expanded[friendId];\n    // if (this.expanded[friendId] && !this.mutualFriendsMap[friendId]) {\n    //   this.friendsService.findMutualFriend(localStorage.getItem(\"userId\"),friendId).subscribe({\n    //     next: (data) => (this.mutualFriendsMap[friendId] =data),\n    //     error: (err) => console.error('Error loading mutual friends', err)\n    //   });\n    // }\n  }\n};\n\nFriendRequestReceivedComponent = __decorate([Component({\n  selector: 'app-friend-request-received',\n  templateUrl: './friend-request-received.component.html',\n  styleUrls: ['./friend-request-received.component.css']\n})], FriendRequestReceivedComponent);","map":{"version":3,"names":["Component","FriendRequestReceivedComponent","constructor","friendsService","router","requests","filteredRequests","searchText","expanded","mutualFriendsMap","ObjectKeys","Object","keys","ngOnInit","loadRequests","viewProfile","friend","alert","username","navigate","userId","getFriendRequestsReceived","localStorage","getItem","subscribe","next","data","i","findMutualFriend","sender","error","err","console","onSearchChange","text","toLowerCase","filter","request","includes","accept","id","acceptFriendRequest","reject","rejectFriendRequest","toggleDropdown","friendId","__decorate","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\ayushman.jha01\\Saved Games\\Facebook_group3\\group3-frontend\\src\\app\\features\\friends\\friend-request-received\\friend-request-received.component.ts"],"sourcesContent":["import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\nimport { FriendsService, Request, UserDTO } from 'src/app/core/services/Friends/friends.service';\n\n@Component({\n  selector: 'app-friend-request-received',\n  templateUrl: './friend-request-received.component.html',\n  styleUrls: ['./friend-request-received.component.css']\n})\n\nexport class FriendRequestReceivedComponent implements OnInit {\n\n  requests: Request[] = [];\n  filteredRequests:Request[]=[];\n  searchText:string='';\n  \n  expanded: { [userId: number]: boolean } = {};\n\n  mutualFriendsMap: { [userId: number]: UserDTO[] } = {};\n\n  ObjectKeys=Object.keys;\n\n  constructor(private friendsService: FriendsService, private router:Router) {}\n\n  ngOnInit(): void {\n\n    this.loadRequests();\n\n  }\n\n  viewProfile(friend:UserDTO):void{\n    alert(`Viewing profile of ${friend.username}`)\n    this.router.navigate(['friends/profile',friend.userId])\n  }\n\n  loadRequests(): void {\n\n    this.friendsService.getFriendRequestsReceived(localStorage.getItem('userId')).subscribe({\n\n      next: data => {\n        this.requests=data;\n        this.filteredRequests=data;\n        for(let i of this.requests){\n          this.friendsService.findMutualFriend(localStorage.getItem(\"userId\"),i.sender.userId).subscribe({\n  \n          next: (data) => {\n            this.mutualFriendsMap[i.sender.userId] =data;\n          },\n          error: (err) => console.error('Error loading mutual friends', err)\n\n          });    \n        }\n\n      },\n\n      error: err => console.error('Error loading received requests', err)\n\n    });\n\n  }\n\n   onSearchChange(): void {\n\n    const text = this.searchText.toLowerCase();\n\n    this.requests = this.filteredRequests.filter(request =>\n      request.sender.username.toLowerCase().includes(text)\n    );\n\n  }\n\n  accept(id: number): void {\n\n    this.friendsService.acceptFriendRequest(id,localStorage.getItem('userId')).subscribe({\n      next:data=>alert(data),\n      error:err=>alert(\"Request can't be accepted\")   \n    });\n    \n  }\n\n  reject(id: number): void {\n    \n    this.friendsService.rejectFriendRequest(id,localStorage.getItem('userId')).subscribe({\n      next:data=>alert(data),\n      error:err=>alert(\"Request can't be rejected\")   \n    });\n\n  }\n // store loaded lists\n\n  toggleDropdown(friendId: number): void {\n\n    this.expanded[friendId] = !this.expanded[friendId];\n\n    // if (this.expanded[friendId] && !this.mutualFriendsMap[friendId]) {\n\n    //   this.friendsService.findMutualFriend(localStorage.getItem(\"userId\"),friendId).subscribe({\n\n    //     next: (data) => (this.mutualFriendsMap[friendId] =data),\n\n    //     error: (err) => console.error('Error loading mutual friends', err)\n\n    //   });\n\n    // }\n\n  }\n  \n\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}